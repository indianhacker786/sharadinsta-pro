<!DOCTYPE html>
<html lang="hi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Sharad Insta Pro - Instagram Reels Downloader</title>
    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <div class="container">
      <h1>Sharad Insta Pro üé¨</h1>
      <p class="notice">
        ‚ö† Reel fetch ‡§π‡•ã‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ <b>1 ‡§Æ‡§ø‡§®‡§ü ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§°</b> ‡§ï‡§∞ ‡§≤‡•á‡§Ç,
        ‡§µ‡§∞‡§®‡§æ ‡§≤‡§ø‡§Ç‡§ï expire ‡§π‡•ã ‡§ú‡§æ‡§è‡§ó‡•Ä‡•§
      </p>

      <input
        type="text"
        id="instaLink"
        placeholder="‡§Ø‡§π‡§æ‡§Å Instagram Reel ‡§≤‡§ø‡§Ç‡§ï ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç..."
      />
      <div class="buttons">
        <button id="pasteBtn">üìã Paste</button>
        <button id="downloadBtn">‚¨á Fetch Reel</button>
      </div>

      <div id="downloadArea" style="margin-top: 20px"></div>
    </div>

    <script>
      document.getElementById("pasteBtn").addEventListener("click", async () => {
        try {
          const text = await navigator.clipboard.readText();
          document.getElementById("instaLink").value = text;
        } catch {
          alert("Clipboard access denied. Paste manually.");
        }
      });

      document
        .getElementById("downloadBtn")
        .addEventListener("click", async () => {
          const link = document.getElementById("instaLink").value.trim();
          const area = document.getElementById("downloadArea");

          if (!link) {
            alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§è‡§ï ‡§µ‡•à‡§ß Instagram ‡§≤‡§ø‡§Ç‡§ï ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§");
            return;
          }

          area.innerHTML = "<p>‚è≥ Fetching reel, please wait...</p>";

          const res = await fetch("/api/download", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ reelUrl: link }),
          });

          const data = await res.json();

          if (data.success) {
            const fileUrl = data.fileUrl;
            area.innerHTML = `
              <p>‚úÖ Reel ready (1 minute valid)</p>
              <video width="100%" controls style="border-radius:8px;margin-top:8px;">
                <source src="${fileUrl}" type="video/mp4">
                Your browser does not support the video tag.
              </video>
              <br />
              <a href="${fileUrl}" download class="downloadBtn">üíæ Save to Device</a>
            `;
          } else {
            area.innerHTML = "<p style='color:red;'>‚ùå Download failed.</p>";
          }
        });
    </script>
  </body>
</html>